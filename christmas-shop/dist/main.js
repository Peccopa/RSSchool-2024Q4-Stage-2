(()=>{"use strict";const e={async getData(e){const t=await fetch(e);return await t.json()}},t={removeLoader(){setTimeout((()=>{document.querySelector(".page").classList.add("opacity-1"),document.querySelector(".loading").classList.add("opacity-0")}),300),setTimeout((()=>{document.querySelector(".loading").style.display="none"}),500)}},s={getScrollWidth(){let e=document.createElement("div");e.style.overflowY="scroll",e.style.width="50px",e.style.height="50px",document.body.append(e);let t=e.offsetWidth-e.clientWidth;return e.remove(),t},hideScroll(){document.body.classList.contains("hide-scroll")?(document.body.classList.remove("hide-scroll"),document.body.style.marginRight="0px"):(document.body.classList.add("hide-scroll"),document.body.style.marginRight=`${this.getScrollWidth()}px`)}},n={menu:document.querySelector(".burger"),nav:document.querySelector(".nav"),openBurgerMenu(){!n.menu.classList.contains("burger_opened")&&window.innerWidth<=768?(n.menu.classList.add("burger_opened"),n.nav.classList.add("nav_opened"),s.hideScroll()):window.innerWidth<=768&&(n.menu.classList.remove("burger_opened"),n.nav.classList.remove("nav_opened"),s.hideScroll())},link(e){}};class a{constructor({name:e,category:t}){this.name=e,this.category=t}getCategoryInOneWord(){return this.category.substring(this.category.lastIndexOf(" ")+1,this.category.length).toLowerCase()}getImagePath(){return window.location.pathname.split("/").length,"./src/img/"}getColor(e){return{work:"purple",health:"green",harmony:"pink"}[e]}generateCard(e,t="before"){const s=this.getCategoryInOneWord(),n=document.createElement("div");n.className="gift-card";const a=document.createElement("div");a.className="gift-card__img",a.style.backgroundImage=`url(${this.getImagePath()}gifts/gift-for-${s}.png)`,n.append(a);const i=document.createElement("div");i.className="gift-card__descr",n.append(i);const r=document.createElement("h4");r.classList=`gift-card__h4 ${this.getColor(s)}`,r.textContent=`${this.category}`,i.append(r);const o=document.createElement("h4");return o.className="gift-card__h3",o.textContent=`${this.name}`,i.append(o),e.append(n),n}}class i extends a{constructor({name:e,category:t,description:s,superpowers:{live:n,create:a,love:i,dream:r}}){super(e,t),this.name=e,this.category=t,this.description=s,this.live=n,this.create=a,this.love=i,this.live=n,this.dream=r}generateModal(e,t="before"){const s=this.generateCard(e,t);s.classList.add("modal");const n=document.createElement("div");n.className="modal__cross",s.append(n);const a=document.createElement("div");a.className="modal__cross-line",n.append(a);const i=document.createElement("div");i.className="modal__cross-line",n.append(i);const r=s.querySelector(".gift-card__descr"),o=document.createElement("p");o.className="modal__descr",o.textContent=this.description,r.append(o);const l=document.createElement("div");l.className="modal__stats",r.append(l);const c=document.createElement("h4");c.classList="stats__header",c.textContent="Adds superpowers to:".toUpperCase(),l.append(c),["live","create","love","dream"].forEach((e=>{const t=document.createElement("div");t.classList="stat",l.append(t);const s=document.createElement("p");s.classList="stat__name",s.textContent=e,t.append(s);const n=document.createElement("div");n.classList="stat__points-block",t.append(n);const a=document.createElement("p");a.classList="stat__points",a.textContent=this[e],n.append(a);const i=document.createElement("div");i.classList="stat__stars-block",n.append(i);let r=parseInt(this[e])/100;for(let e=0;e<5;e+=1){const e=document.createElement("div");e.className="stat__star",r<=0&&(e.style.opacity="0.1"),r-=1,i.append(e)}}))}logs(){console.log(this.name,this.category,this.description,this.live)}}const r={getDate(){const e=(new Date).getFullYear()+1,t=new Date(e,0,1,0,0,0).getTime(),s=(new Date).getTime(),n=Math.trunc((t-s)/1e3),a=Math.trunc(n/86400),i=Math.trunc((n-86400*a)/3600),r=Math.trunc((n-86400*a-3600*i)/60);return{days:a,hours:i,minutes:r,seconds:n-86400*a-3600*i-60*r}},startTimer(){setInterval((()=>{Object.entries(this.getDate()).forEach((e=>{document.querySelector(`.${e[0]}-count`).textContent=e[1]}))}),1e3)},getRandomNumber:(e,t)=>Math.floor(Math.random()*(t-e+1))+e,gеtArrayOfRandomNumbers(e,t){const s=[];let n=0;for(;n<e;){let e=this.getRandomNumber(0,t.length-1);s.includes(e)?n-=1:s.push(e),n+=1}return s}},o={parent:document.querySelector(".gifts__cards"),tabs:document.querySelector(".tabs"),data:{},changeSelectedTab(e){document.querySelectorAll(".tab").forEach((e=>e.classList.remove("tab_selected"))),e.target.classList.add("tab_selected")},getTabCategoryArray(e){const t=e.target.innerText.replace("FOR ","").toLowerCase();return o.data.filter((e=>e.category.replace("For ","").toLowerCase()===t))},clickOnTabs(e){if(e.target.classList.contains("tab")){o.changeSelectedTab(e);let t=document.querySelectorAll(".gift-card");t.forEach((e=>{e.classList.add("gift-card_anim")})),setTimeout((()=>{if("ALL"===e.target.innerText)o.generateGiftsCardsBlock(o.data);else{const t=o.getTabCategoryArray(e);o.generateGiftsCardsBlock(t)}t=document.querySelectorAll(".gift-card");let s=100;t.forEach((e=>{e.classList.add("gift-card_anim"),setTimeout((()=>{e.classList.remove("gift-card_anim")}),s),s+=100}))}),300)}},generateGiftsCardsBlock(e){o.parent.innerHTML="",r.gеtArrayOfRandomNumbers(12,e).forEach((t=>{new a(e[t]).generateCard(o.parent)}))}},l={checkPageAndGoToAnother(e){window.location.href=window.location.pathname.split("/").length>3?"../../index.html":"./index.html"},goToGiftsPage(e){e.target.classList.add("nav__link_active"),n.menu.classList.contains("burger_opened")?(setTimeout((()=>{document.querySelector(".main").classList.add("opacity-0")}),300),setTimeout((function(){window.location.href="./src/pages/gifts.html"}),600)):(document.querySelector(".main").classList.add("opacity-0"),setTimeout((function(){window.location.href="./src/pages/gifts.html"}),300))},checkClick(e){const t=n.menu.classList.contains("burger_opened")?300:0,a=e.target.classList,r=document.querySelector(".overlay");if("gift-card"===a.value.substring(0,9)&&!r.classList.contains("show-overlay")){r.classList.add("show-overlay"),s.hideScroll(),document.addEventListener("keyup",l.escapeListener);const t=e.target.closest(".gift-card").querySelector(".gift-card__h3").textContent,n=o.data.find((e=>e.name===t));new i(n).generateModal(document.querySelector(".overlay"))}a.contains("overlay")&&(a.remove("show-overlay"),s.hideScroll(),document.removeEventListener("keyup",l.escapeListener),l.removeModalCard()),"modal"===a.value.substring(0,5)&&"modal__descr"!==a.value&&(document.querySelector(".overlay").classList.remove("show-overlay"),s.hideScroll(),document.removeEventListener("keyup",l.escapeListener),l.removeModalCard()),a.contains("gifts-link")&&l.goToGiftsPage(e),a.contains("home-link")?(n.menu.classList.contains("burger_opened")&&n.openBurgerMenu(),setTimeout((()=>{document.querySelector(".main").classList.add("opacity-0")}),t),setTimeout(l.checkPageAndGoToAnother,t+300)):a.contains("home-link_about")?(document.querySelector(".nav__link_active").classList.remove("nav__link_active"),e.target.classList.add("nav__link_active"),setTimeout((()=>{document.querySelector(".main").classList.add("opacity-0")}),t),setTimeout((function(){window.location.href="../../index.html#about"}),t+300)):a.contains("home-link_best")&&(document.querySelector(".nav__link_active").classList.remove("nav__link_active"),e.target.classList.add("nav__link_active"),setTimeout((()=>{document.querySelector(".main").classList.add("opacity-0")}),t),setTimeout((function(){window.location.href="../../index.html#best"}),t+300)),a.contains("nav__link")&&n.openBurgerMenu()},escapeListener(e){"Escape"===e.key&&(document.querySelector(".overlay").classList.remove("show-overlay"),s.hideScroll(),document.removeEventListener("keyup",l.escapeListener),l.removeModalCard())},removeModalCard(){setTimeout((()=>{document.querySelector(".modal").remove()}),150)}},c={sliderSec:document.querySelector(".slider"),sliderBtns:document.querySelector(".slider__btns"),sliderClip:document.querySelector(".slider__clip"),sliderBtnLeft:document.querySelector(".slider-button.left"),sliderBtnRght:document.querySelector(".slider-button.right"),sliderAnimationEnd(){c.sliderBtns.addEventListener("click",c.sliderClickTrash)},sliderResize(){c.sliderClip.style.left="0px",c.sliderBtnLeft.classList.add("slider-button_inactive"),c.sliderBtnRght.classList.remove("slider-button_inactive")},sliderClick(e){if(!e.target.classList.contains("slider__btns")){const t=parseFloat(getComputedStyle(c.sliderSec).width),s=getComputedStyle(c.sliderClip),n=2*parseFloat(s.marginLeft)+parseFloat(s.width),a=Math.floor(n/t),i=Math.trunc((n-t)/a),r=parseFloat(getComputedStyle(c.sliderClip).left);e.target.classList.contains("right")&&(r!==-i*a&&(c.sliderClip.style.left=r-i+"px",c.sliderBtnLeft.classList.remove("slider-button_inactive"),c.sliderBtns.removeEventListener("click",c.sliderClick),c.sliderClip.addEventListener("transitionend",c.sliderAnimationEnd)),r-i==-i*a&&c.sliderBtnRght.classList.add("slider-button_inactive")),e.target.classList.contains("left")&&(0!==r&&(c.sliderClip.style.left=`${r+i}px`,c.sliderBtnRght.classList.remove("slider-button_inactive"),c.sliderBtns.removeEventListener("click",c.sliderClick),c.sliderClip.addEventListener("transitionend",c.sliderAnimationEnd)),"0px"===c.sliderClip.style.left&&c.sliderBtnLeft.classList.add("slider-button_inactive"))}},sliderClickTrash(e){if(!e.target.classList.contains("slider__btns")){const t=parseFloat(getComputedStyle(c.sliderClip).left),s=parseFloat(getComputedStyle(c.sliderSec).width),n=getComputedStyle(c.sliderClip),a=2*parseFloat(n.marginLeft)+parseFloat(n.width),i=s>768?3:6,r=Math.trunc((a-s)/i);e.target.classList.contains("right")&&(t-r==-r*i&&c.sliderBtnRght.classList.add("slider-button_inactive"),t!==-r*i&&(c.sliderClip.style.left=t-r+"px",c.sliderBtnLeft.classList.remove("slider-button_inactive"),c.sliderBtns.removeEventListener("click",c.sliderClickTrash),c.sliderClip.addEventListener("transitionend",c.sliderAnimationEnd))),e.target.classList.contains("left")&&(-parseFloat(c.sliderClip.style.left)===r&&c.sliderBtnLeft.classList.add("slider-button_inactive"),0!==t&&(c.sliderClip.style.left=`${t+r}px`,c.sliderBtnRght.classList.remove("slider-button_inactive"),c.sliderBtns.removeEventListener("click",c.sliderClickTrash),c.sliderClip.addEventListener("transitionend",c.sliderAnimationEnd)))}}},d={showPageUpIco(){const e=document.querySelector(".pageup");window.scrollY>=300?e.classList.remove("invisible"):e.classList.add("invisible")}};window.addEventListener("load",(t=>{const s=window.location.pathname.includes("gifts")?"../data/gifts.json":"./src/data/gifts.json";e.getData(s).then((e=>{m(e)}))}));const m=function(e){if(o.data=e,t.removeLoader(),window.addEventListener("click",l.checkClick),n.menu.addEventListener("click",n.openBurgerMenu),"/christmas-shop/src/pages/gifts.html"===window.location.pathname)e&&o.generateGiftsCardsBlock(e),window.addEventListener("scroll",d.showPageUpIco),o.tabs.addEventListener("click",o.clickOnTabs);else{if(e){const t=document.querySelector(".best__cards");t.innerHTML="",r.gеtArrayOfRandomNumbers(4,e).forEach((s=>{new a(e[s]).generateCard(t)}))}window.addEventListener("resize",c.sliderResize),c.sliderBtns.addEventListener("click",c.sliderClickTrash),r.startTimer()}};console.log("\n")})();